<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>æ¸¸æ³³èª²ç¨‹æ™‚é–“è¦åŠƒå™¨ - å°ˆæ¥­ç‰ˆ</title>
<style>
* { box-sizing: border-box; margin: 0; padding: 0; }

html, body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  background: #eaf6ff;
  height: 100%;
  overflow: hidden; /* é˜²æ­¢ä¸»é é¢æ•´é«”æ™ƒå‹• */
}

.app {
  display: flex;
  flex-direction: column;
  height: 100vh;
}

/* ä¸»å…§å®¹å€ï¼šç•™å‡ºåº•éƒ¨ç©ºé–“çµ¦éµç›¤ */
.main {
  flex: 1;
  overflow-y: auto;
  padding: 16px;
  padding-bottom: 35vh; /* ç•¥å¤§æ–¼éµç›¤é«˜åº¦ï¼Œç¢ºä¿å…§å®¹ä¸è¢«é®ä½ */
}

.container { max-width: 480px; margin: auto; }

h1 { text-align: center; font-size: 20px; color: #0b5394; margin-bottom: 16px; }

.section { margin-bottom: 12px; }
.label { font-weight: 600; font-size: 14px; margin-bottom: 4px; display: block; color: #444; }

.input-card { display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; }

/* é™åˆ¶åŸç”Ÿéµç›¤èˆ‡å…‰æ¨™ */
input {
  width: 100%;
  padding: 12px;
  font-size: 18px;
  border-radius: 10px;
  border: 1px solid #bbb;
  text-align: center;
  background: #fff;
  box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  transition: all 0.2s;
  /* ç¦æ­¢æ‰‹æ©Ÿå½ˆå‡ºåŸç”Ÿéµç›¤ */
  inputmode: none;
}

input:focus {
  outline: none;
  border: 2px solid #1abc9c;
  background: #f0fffd;
}

/* æŒ‰éˆ•æ¨£å¼ */
.btn-group { display: flex; gap: 8px; margin-top: 10px; }
button.action {
  flex: 1;
  padding: 12px;
  font-size: 16px;
  border: none;
  border-radius: 10px;
  color: #fff;
  font-weight: bold;
  cursor: pointer;
  transition: 0.1s;
}
.btn-add { background: linear-gradient(145deg, #1abc9c, #16a085); }
.btn-clear { background: #95a5a6; }
button.action:active { transform: scale(0.97); opacity: 0.9; }

/* çµ±è¨ˆè³‡è¨Š */
.summary {
  padding: 12px;
  border-radius: 12px;
  font-weight: bold;
  margin: 15px 0;
  text-align: center;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.ok { background: #d1f2eb; color: #16a085; }
.over { background: #fadbd8; color: #c0392b; }

/* èª²ç¨‹åˆ—è¡¨ */
.item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px;
  margin-bottom: 8px;
  border-radius: 10px;
  background: #fff;
  border-left: 5px solid #3498db;
  box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}
.delete { color: #e74c3c; font-weight: bold; padding: 5px 10px; }

/* ===== ä¿®æ­£å¾Œï¼šè™›æ“¬éµç›¤å€ ===== */
.numpad {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  height: 33.33vh; /* åš´æ ¼é™åˆ¶é«˜åº¦ç‚º 1/3 è¢å¹• */
  background: #d4e6f1;
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  grid-template-rows: repeat(4, 1fr); /* 4æ©«åˆ—å‡åˆ† */
  gap: 4px;
  padding: 6px;
  box-shadow: 0 -3px 10px rgba(0,0,0,0.1);
  z-index: 1000;
}

.numpad button {
  border: none;
  border-radius: 8px;
  font-size: 22px;
  font-weight: 600;
  background: #fff;
  color: #2c3e50;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 2px 0 #bdc3c7;
}

.numpad button:active {
  background: #ebf5fb;
  transform: translateY(2px);
  box-shadow: none;
}

/* ç‰¹æ®ŠæŒ‰éˆ•é¡è‰² */
.numpad .btn-util { background: #fdfefe; color: #e67e22; }
.numpad .btn-del { background: #fdfefe; color: #c0392b; }
</style>
</head>
<body>

<div class="app">
  <div class="main">
    <div class="container">
      <h1>ğŸŠ æ¸¸æ³³èª²ç¨‹è¦åŠƒå™¨</h1>

      <div class="section">
        <span class="label">èª²å ‚ç¸½æ™‚é–“ï¼ˆåˆ†é˜ï¼‰</span>
        <input id="classTime" placeholder="ä¾‹å¦‚ï¼š60">
      </div>

      <div class="section">
        <span class="label">å–®è¶Ÿæ™‚é–“</span>
        <div class="input-card">
          <input id="lapMin" placeholder="åˆ†">
          <input id="lapSec" placeholder="ç§’">
        </div>
      </div>

      <div class="section">
        <span class="label">çµæ§‹ï¼šæ¯çµ„è¶Ÿæ•¸ / ç¸½çµ„æ•¸</span>
        <div class="input-card">
          <input id="lapsPerSet" placeholder="è¶Ÿæ•¸">
          <input id="sets" placeholder="çµ„æ•¸">
        </div>
      </div>

      <div class="section">
        <span class="label">æ¯çµ„é–“ä¼‘æ¯</span>
        <div class="input-card">
          <input id="restMin" placeholder="åˆ†">
          <input id="restSec" placeholder="ç§’">
        </div>
      </div>

      <div class="btn-group">
        <button class="action btn-add" onclick="addItem()">â• åŠ å…¥èª²ç¨‹</button>
        <button class="action btn-clear" onclick="clearAll()">ğŸ—‘ æ¸…ç©º</button>
      </div>

      <div id="summary" class="summary ok">â³ è«‹è¼¸å…¥ç¸½æ™‚é–“é–‹å§‹è¦åŠƒ</div>
      <div id="list" class="list"></div>
    </div>
  </div>

  <div class="numpad">
    <button onclick="num(7)">7</button>
    <button onclick="num(8)">8</button>
    <button onclick="num(9)">9</button>
    <button onclick="num(4)">4</button>
    <button onclick="num(5)">5</button>
    <button onclick="num(6)">6</button>
    <button onclick="num(1)">1</button>
    <button onclick="num(2)">2</button>
    <button onclick="num(3)">3</button>
    <button class="btn-util" onclick="clearInput()">AC</button>
    <button onclick="num(0)">0</button>
    <button class="btn-del" onclick="back()">âŒ«</button>
  </div>
</div>

<script>
let activeInput = null;
let items = [];

const formatTime = s => {
  const m = Math.floor(Math.abs(s) / 60);
  const sec = Math.abs(s) % 60;
  return `${m}åˆ†${sec}ç§’`;
};

// åˆå§‹åŒ–è¼¸å…¥ç›£è½
document.querySelectorAll("input").forEach(i => {
  i.addEventListener("focus", () => activeInput = i);
  // é»æ“Šå³èšç„¦
  i.addEventListener("click", () => i.focus());
});

// è™›æ“¬éµç›¤åŠŸèƒ½
function num(n) { if(activeInput) activeInput.value += n; render(); }
function back() { if(activeInput) activeInput.value = activeInput.value.slice(0,-1); render(); }
function clearInput() { if(activeInput) activeInput.value = ''; render(); }

function addItem() {
  const lapTime = (+lapMin.value || 0) * 60 + (+lapSec.value || 0);
  const laps = (+lapsPerSet.value || 0);
  const setsNum = (+sets.value || 0);
  const restTime = ((+restMin.value || 0) * 60 + (+restSec.value || 0)) * Math.max(setsNum - 1, 0);
  
  const total = (lapTime * laps * setsNum) + restTime;
  
  if(total <= 0) return alert("è«‹è¼¸å…¥æœ‰æ•ˆçš„æ™‚é–“èˆ‡çµ„æ•¸");

  items.push({
    desc: `${laps}è¶Ÿ x ${setsNum}çµ„`,
    seconds: total
  });
  
  // åŠ å…¥å¾Œæ¸…ç©ºéƒ¨åˆ†è¼¸å…¥æ¡†ï¼Œæ–¹ä¾¿ä¸‹ä¸€é …è¼¸å…¥
  lapMin.value = lapSec.value = lapsPerSet.value = sets.value = restMin.value = restSec.value = "";
  render();
}

function render() {
  const totalLimit = (+classTime.value || 0) * 60;
  const usedSeconds = items.reduce((sum, item) => sum + item.seconds, 0);
  const remaining = totalLimit - usedSeconds;

  const listEl = document.getElementById("list");
  listEl.innerHTML = "";
  
  items.forEach((item, i) => {
    const d = document.createElement("div");
    d.className = "item";
    d.innerHTML = `
      <div><strong>#${i+1}</strong> ${item.desc}</div>
      <div>${formatTime(item.seconds)} <span class="delete" onclick="del(${i})">âœ•</span></div>
    `;
    listEl.appendChild(d);
  });

  const summaryEl = document.getElementById("summary");
  if(totalLimit === 0) {
    summaryEl.className = "summary ok";
    summaryEl.innerHTML = "è«‹å…ˆè¨­å®šèª²å ‚ç¸½æ™‚é–“";
  } else if (remaining >= 0) {
    summaryEl.className = "summary ok";
    summaryEl.innerHTML = `â³ å‰©é¤˜å¯ç”¨ï¼š${formatTime(remaining)}`;
  } else {
    summaryEl.className = "summary over";
    summaryEl.innerHTML = `âš ï¸ è¶…å‡ºæ™‚é–“ï¼š${formatTime(remaining)}`;
  }
}

function del(i) {
  items.splice(i, 1);
  render();
}

function clearAll() {
  if(confirm("ç¢ºå®šè¦é‡ç½®æ‰€æœ‰é …ç›®å—ï¼Ÿ")) {
    items = [];
    render();
  }
}
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
<title>æ¸¸æ³³èª²ç¨‹æ™‚é–“è¦åŠƒå™¨</title>

<style>
* {
    box-sizing: border-box;
}

html, body {
    margin: 0;
    padding: 0;
    background: #eaf6ff;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto;
    touch-action: manipulation; /* é˜²é›™é»æ”¾å¤§ï¼Œä¿ç•™é›™æŒ‡ */
}

body {
    padding:
        env(safe-area-inset-top)
        env(safe-area-inset-right)
        env(safe-area-inset-bottom)
        env(safe-area-inset-left);
}

.container {
    max-width: 480px;
    margin: auto;
    background: #fff;
    padding: 16px;
    border-radius: 16px;
    box-shadow: 0 6px 16px rgba(0,0,0,.15);
}

h1 {
    text-align: center;
    font-size: 20px;
    color: #0b5394;
    margin-bottom: 12px;
}

.section {
    margin-top: 12px;
}

.label {
    font-weight: 600;
    margin-bottom: 6px;
}

.grid-2 {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 8px;
}

input {
    width: 100%;
    padding: 10px;
    font-size: 16px;
    border-radius: 10px;
    border: 1px solid #bbb;
    text-align: center;
}

button {
    width: 100%;
    margin-top: 14px;
    padding: 14px;
    font-size: 17px;
    background: #1abc9c;
    color: #fff;
    border: none;
    border-radius: 12px;
}

.summary {
    margin-top: 14px;
    padding: 12px;
    border-radius: 12px;
}

.ok { background: #e8f8f5; }
.over { background: #fdecea; color: #c0392b; }

/* ===== ä¹å®®æ ¼éµç›¤ ===== */
.numpad {
    position: fixed;
    left: 0;
    right: 0;
    bottom: env(safe-area-inset-bottom);
    background: #f8f9fa;
    padding: 10px;
    display: none;
    grid-template-columns: repeat(3, 1fr);
    gap: 8px;
}

.numpad button {
    font-size: 20px;
    padding: 14px 0;
    border-radius: 10px;
    background: #fff;
    border: 1px solid #ccc;
}
</style>
</head>

<body>

<div class="container">
    <h1>ğŸŠ èª²ç¨‹æ™‚é–“è¦åŠƒå™¨</h1>

    <div class="section">
        <div class="label">èª²å ‚ç¸½æ™‚é–“ï¼ˆåˆ†é˜ï¼‰</div>
        <input data-num id="classTime">
    </div>

    <div class="section">
        <div class="label">æ¯è¶Ÿæ™‚é–“</div>
        <div class="grid-2">
            <input data-num id="lapMin" placeholder="åˆ†">
            <input data-num id="lapSec" placeholder="ç§’">
        </div>
    </div>

    <div class="section grid-2">
        <input data-num id="lapsPerSet" placeholder="æ¯çµ„å¹¾è¶Ÿ">
        <input data-num id="sets" placeholder="çµ„æ•¸">
    </div>

    <div class="section">
        <div class="label">æ¯çµ„ä¼‘æ¯</div>
        <div class="grid-2">
            <input data-num id="restMin" placeholder="åˆ†">
            <input data-num id="restSec" placeholder="ç§’">
        </div>
    </div>

    <button onclick="addItem()">â• åŠ å…¥èª²ç¨‹</button>

    <div id="summary" class="summary ok">â³ å°šæœªè¨ˆç®—</div>
    <div id="list"></div>
</div>

<!-- ä¹å®®æ ¼éµç›¤ -->
<div class="numpad" id="numpad">
    <button onclick="num(7)">7</button>
    <button onclick="num(8)">8</button>
    <button onclick="num(9)">9</button>
    <button onclick="num(4)">4</button>
    <button onclick="num(5)">5</button>
    <button onclick="num(6)">6</button>
    <button onclick="num(1)">1</button>
    <button onclick="num(2)">2</button>
    <button onclick="num(3)">3</button>
    <button onclick="num(0)">0</button>
    <button onclick="back()">âŒ«</button>
    <button onclick="hide()">âœ”</button>
</div>

<script>
let focusInput = null;
let remaining = null;
let items = [];

document.querySelectorAll("[data-num]").forEach(i => {
    i.addEventListener("focus", () => {
        focusInput = i;
        numpad.style.display = "grid";
    });
});

function num(n) {
    if (focusInput) focusInput.value += n;
}
function back() {
    if (focusInput)
        focusInput.value = focusInput.value.slice(0, -1);
}
function hide() {
    numpad.style.display = "none";
}

const f = s => `${Math.floor(s/60)} åˆ† ${s%60} ç§’`;

function addItem() {
    if (remaining === null)
        remaining = (classTime.value || 0) * 60;

    const lap = lapMin.value*60 + +lapSec.value;
    const swim = lap * lapsPerSet.value * sets.value;
    const rest = (restMin.value*60 + +restSec.value) * Math.max(sets.value-1,0);
    const total = swim + rest;

    remaining -= total;
    items.push(total);

    summary.className = "summary " + (remaining>=0?"ok":"over");
    summary.innerHTML = remaining>=0
        ? `â³ å‰©é¤˜ï¼š${f(remaining)}`
        : `âš ï¸ è¶…éï¼š${f(-remaining)}`;
}
</script>
</body>
</html>

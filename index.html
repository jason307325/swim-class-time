<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>游泳規劃器 CYBERPUNK</title>
<style>
/* ===== 核心 & 重置 ===== */
* { box-sizing: border-box; margin:0; padding:0; touch-action: manipulation; -webkit-tap-highlight-color: transparent; }
:root{
  --primary:#00f0ff; --accent:#ff00ff; --success:#0f0; --warn:#ff3b30;
  --bg-dark:#05060a; --panel:#10121a; --input:#1b1d27;
}
html,body{
  font-family:"SF Pro Text","PingFang TC","Helvetica Neue",sans-serif;
  background:radial-gradient(circle at 30% 20%, #0c0d12 0%, #05060a 100%);
  height:100dvh; color:#fff; overflow:hidden;
}
.app{ display:flex; flex-direction:column; height:100dvh; }

/* ===== Header & 靈動島避讓 ===== */
.fixed-header{
  flex-shrink:0;
  background: linear-gradient(180deg,#0d0f16,#05060a);
  border-bottom:1px solid #222;
  padding-top:calc(env(safe-area-inset-top,15px) + 5px);
}
.header-hud{
  display:flex; justify-content:space-between; align-items:flex-end;
  padding:5px 15px 10px;
}
.time-overlay{
  position:relative; text-align:right; min-width:130px;
  background: rgba(20,20,40,0.6); padding:6px 10px; border-radius:10px;
  border:1px solid #333; box-shadow:0 0 8px #000 inset;
}
.bg-number{
  position:absolute; right:10px; bottom:0; font-size:48px; font-weight:900;
  color:#111; opacity:0.6; transform:scaleX(1.4); transform-origin:right; z-index:1; pointer-events:none;
}
.main-number{
  position:relative; z-index:2; font-size:24px; font-weight:900;
  color:var(--success); text-shadow:0 0 8px var(--success),0 0 16px var(--accent);
  transform:scaleX(1.05); transform-origin:right;
}

/* ===== 輸入格區塊 ===== */
.input-section{
  padding:12px 15px; display:flex; flex-direction:column; gap:10px;
}
.label-sm{ font-size:10px; color:#888; font-weight:800; margin-bottom:2px; display:block; letter-spacing:0.5px; }

.row{ display:flex; gap:10px; }

.input-box{
  background:var(--input); border:2px solid #333; border-radius:10px;
  padding:8px; flex:1; transition:0.2s; box-shadow:0 0 6px #000 inset;
}
.input-box.active{
  border-color:var(--primary); box-shadow:0 0 12px var(--primary),0 0 6px var(--primary) inset;
}

.val-group{ display:flex; align-items:baseline; justify-content:center; }
.val-group input{
  width:100%; background:transparent; border:none; color:#fff;
  font-size:20px; font-weight:800; text-align:center; outline:none;
}
.unit{ font-size:9px; color:#888; font-weight:bold; margin-left:2px; }

/* ===== 按鈕 ===== */
.btn-add{
  background: linear-gradient(145deg,var(--primary),#005577);
  color:white; border:1px solid var(--primary); border-radius:8px;
  font-size:14px; font-weight:900; box-shadow:0 4px 10px #0005;
}
.btn-add:active{ transform:translateY(1px); opacity:0.9; }

/* ===== 列表 ===== */
.main-content{ flex:1; overflow-y:auto; padding:10px 15px; -webkit-overflow-scrolling:touch; }
.course-item{
  background: linear-gradient(145deg,#101122,#1a1b2a);
  padding:12px; border-radius:10px; margin-bottom:8px;
  display:flex; justify-content:space-between; align-items:center;
  border-left:4px solid var(--accent);
}
.item-info b{ font-size:13px; color:#fff; text-shadow:0 0 4px var(--accent);}
.item-info p{ font-size:10px; color:#aaa; }
.item-time{ font-size:16px; font-weight:800; color:#fff; text-shadow:0 0 4px var(--primary); }

/* ===== 底部鍵盤 & Footer ===== */
.fixed-footer{
  flex-shrink:0; background:#05060a; border-top:1px solid #222;
  padding-bottom:max(10px,env(safe-area-inset-bottom));
}
.footer-ctrl{ display:flex; justify-content:space-between; align-items:center; padding:6px 15px; }
.btn-reset{
  background:#111; color:var(--warn); border:1px solid var(--warn);
  padding:3px 10px; border-radius:5px; font-size:10px; font-weight:bold;
}
.numpad{
  display:grid; grid-template-columns:repeat(3,1fr); gap:8px; padding:5px 15px;
}
.numpad button{
  border:1px solid #333; background: linear-gradient(145deg,#1b1c28,#0f101a);
  font-size:24px; font-weight:600; color:white; border-radius:10px; padding:10px 0;
  box-shadow:2px 2px 6px #0005, -1px -1px 3px #111;
}
.numpad button:active{ background:#111; box-shadow: inset 2px 2px 5px #000; }
.btn-util{ color:#666 !important; font-size:14px !important; }

.warn{ color:var(--warn) !important; text-shadow:0 0 8px var(--warn); }

/* ===== 排列示意 (賽博龐克風格) ===== */
.section-group{ display:flex; gap:10px; }
.section-group .input-box{ flex:1; }

/* ===== Neon Glow Effect for Cyberpunk ===== */
.input-box, .btn-add, .numpad button{ transition: all 0.2s ease-in-out; }
.input-box.active{ box-shadow:0 0 12px var(--primary), 0 0 6px var(--accent) inset; }
</style>
</head>
<body>
<div class="app">
  <header class="fixed-header">
    <div class="header-hud">
      <div>
        <span class="label-sm">總長度 (分)</span>
        <div class="input-box" id="box-classTime" style="width:85px;">
          <div class="val-group"><input id="classTime" readonly placeholder="0"></div>
        </div>
      </div>
      <div class="time-overlay">
        <span class="label-sm">剩餘可用</span>
        <div id="bgTotal" class="bg-number">00</div>
        <div id="remainingText" class="main-number">0分00秒</div>
      </div>
    </div>

    <section class="input-section">
      <!-- 單趟時間 -->
      <div class="section-group">
        <div class="input-box" id="box-lapMin"><div class="val-group"><input id="lapMin" readonly data-next="lapSec"><span class="unit">分</span></div></div>
        <div class="input-box" id="box-lapSec"><div class="val-group"><input id="lapSec" readonly data-next="lapsPerSet"><span class="unit">秒</span></div></div>
      </div>
      <!-- 組數趟數 -->
      <div class="section-group">
        <div class="input-box" id="box-lapsPerSet"><div class="val-group"><input id="lapsPerSet" readonly data-next="sets"><span class="unit">趟</span></div></div>
        <div class="input-box" id="box-sets"><div class="val-group"><input id="sets" readonly data-next="restMin"><span class="unit">組</span></div></div>
      </div>
      <!-- 休息時間 + 加入項目 -->
      <div class="section-group">
        <div class="input-box" id="box-restMin"><div class="val-group"><input id="restMin" readonly data-next="restSec"><span class="unit">分</span></div></div>
        <div class="input-box" id="box-restSec"><div class="val-group"><input id="restSec" readonly><span class="unit">秒</span></div></div>
        <button class="btn-add" onclick="addItem()">加入項目 (+)</button>
      </div>
    </section>
  </header>

  <main class="main-content" id="scrollArea">
    <div id="listContainer"></div>
  </main>

  <footer class="fixed-footer">
    <div class="footer-ctrl">
      <span style="font-size:9px;color:#888;">LONG PRESS TO DELETE</span>
      <button class="btn-reset" onclick="clearAll()">重置資料</button>
    </div>
    <div class="numpad">
      <button onclick="num(7)">7</button><button onclick="num(8)">8</button><button onclick="num(9)">9</button>
      <button onclick="num(4)">4</button><button onclick="num(5)">5</button><button onclick="num(6)">6</button>
      <button onclick="num(1)">1</button><button onclick="num(2)">2</button><button onclick="num(3)">3</button>
      <button class="btn-util" onclick="clearInput()">AC</button>
      <button onclick="num(0)">0</button>
      <button class="btn-util" onclick="back()" style="color:var(--warn)">⌫</button>
    </div>
  </footer>
</div>

<script>
let activeInput=document.getElementById("classTime"),items=[],pressTimer=null;
const vibrate=ms=>navigator.vibrate&&navigator.vibrate(ms);
const formatTimeCH=s=>`${Math.floor(s/60)}分${(s%60).toString().padStart(2,'0')}秒`;
function updateFocusUI(el){document.querySelectorAll('.input-box').forEach(b=>b.classList.remove('active'));el.closest('.input-box')?.classList.add('active');}
document.querySelectorAll("input").forEach(input=>input.addEventListener("click",e=>{activeInput=input;updateFocusUI(input);e.stopPropagation();}));
function num(n){if(!activeInput)return;if(activeInput.value.length>=3&&activeInput.id!=="classTime")return;if(activeInput.id==="classTime"&&activeInput.value.length>=3)return;activeInput.value+=n;vibrate(10);render();if(activeInput.value.length===2&&activeInput.id!=="classTime"){const next=document.getElementById(activeInput.dataset.next);if(next&&next.value===""){activeInput=next;updateFocusUI(next);}}}
function back(){if(activeInput&&activeInput.value.length>0){activeInput.value=activeInput.value.slice(0,-1);render();}}
function clearInput(){if(activeInput){activeInput.value="";render();}}
function addItem(){const g=id=>+document.getElementById(id).value||0;const lm=g("lapMin"),ls=g("lapSec"),lps=g("lapsPerSet"),st=g("sets"),rm=g("restMin"),rs=g("restSec");if(st<=0||lps<=0){vibrate([40,40]);return;}const total=((lm*60+ls)*lps*st)+((rm*60+rs)*(st>1?st-1:0));items.push({id:Date.now(),desc:`${lps}趟 x ${st}組`,seconds:total});vibrate(20);["lapMin","lapSec","lapsPerSet","sets","restMin","restSec"].forEach(id=>document.getElementById(id).value="");activeInput=document.getElementById("lapMin");updateFocusUI(activeInput);render();setTimeout(()=>document.getElementById("scrollArea").scrollTo({top:document.getElementById("scrollArea").scrollHeight,behavior:'smooth'}),100);}
function render(){const classVal=+document.getElementById("classTime").value||0;document.getElementById("bgTotal").innerText=classVal.toString().padStart(2,'0');const used=items.reduce((s,i)=>s+i.seconds,0);const remaining=(classVal*60)-used;const rText=document.getElementById("remainingText");rText.innerText=formatTimeCH(remaining);rText.classList.toggle("warn",remaining<0);const container=document.getElementById("listContainer");container.innerHTML="";items.forEach((item,index)=>{const div=document.createElement("div");div.className="course-item";div.innerHTML=`<div class="item-info"><b>項目 #${index+1}</b><p>${item.desc}</p></div><div class="item-time">${formatTimeCH(item.seconds)}</div>`;div.ontouchstart=()=>{pressTimer=setTimeout(()=>{vibrate(50);if(confirm("刪除此項目？")){items.splice(index,1);render();}},600);};div.ontouchend=()=>clearTimeout(pressTimer);container.appendChild(div);});}
function clearAll(){if(confirm("確定清空所有數據？")){items=[];document.getElementById("classTime").value="";render();vibrate(60);}}
updateFocusUI(activeInput);render();
</script>
</body>
</html>

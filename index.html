<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<title>æ¸¸æ³³è¦åŠƒå¤§å¸« Pro</title>

<style>
:root {
  --bg-dark:#0d1117;
  --neon-blue:#00a2ff;
  --neon-green:#4cd964;
  --neon-red:#ff3b30;
  --panel-grad:linear-gradient(180deg,#1e242e 0%,#141820 100%);
}

*{box-sizing:border-box;margin:0;padding:0;-webkit-user-select:none;user-select:none}

body{
  font-family:-apple-system,"PingFang TC",sans-serif;
  background:var(--bg-dark);
  color:#fff;
  height:100dvh;
  display:flex;
  flex-direction:column;
  overflow:hidden;
}

/* ===== HUD ===== */
.hud-container{
  padding:calc(env(safe-area-inset-top,10px) + 10px) 15px 10px;
  display:flex;
  justify-content:space-between;
  align-items:flex-end;
}

.hud-block{text-align:center;flex:1}
.hud-block.left{text-align:left}
.hud-block.right{text-align:right}

.label-sm{font-size:11px;color:#888;font-weight:600;margin-bottom:5px;display:block}

.glass-box{
  background:#090c10;
  border-radius:8px;
  border:2px solid #1a2028;
  display:flex;
  align-items:center;
  justify-content:center;
}

.glass-box input{
  background:transparent;border:none;color:#fff;
  font-size:20px;font-weight:800;text-align:center;width:100%;
}

.main-number{
  font-size:32px;
  font-weight:900;
  color:var(--neon-green);
}

.dist-big{
  font-size:20px;
  font-weight:900;
  color:var(--neon-blue);
}

.warn{color:var(--neon-red)!important}

/* ===== Panel ===== */
.panel{
  margin:0 15px 8px;
  padding:12px;
  border-radius:12px;
  background:var(--panel-grad);
  border:1px solid #2a323d;
}

.row{display:flex;gap:8px;margin-bottom:8px}

.unit{font-size:9px;color:#666;margin-left:2px}

.btn-add{
  flex:1.5;
  height:42px;
  background:linear-gradient(180deg,#007aff 0%,#004a99 100%);
  border:1px solid var(--neon-blue);
  border-radius:8px;
  color:#fff;
  font-weight:800;
}

/* ===== List ===== */
.list-area{
  flex:1;
  overflow-y:auto;
  margin:5px 15px;
}

.course-card{
  background:rgba(255,255,255,.04);
  border-radius:8px;
  padding:12px;
  margin-bottom:8px;
  border:1px solid #222;
  display:flex;
  justify-content:space-between;
}

.course-card b{font-size:14px}
.course-card p{font-size:11px;color:#aaa;margin-top:2px}

/* ===== Footer ===== */
.fixed-footer{
  background:#0a0d12;
  border-top:1px solid #222;
  padding:5px 15px calc(env(safe-area-inset-bottom,15px) + 8px);
}

.footer-ctrl{
  display:flex;
  justify-content:space-between;
  margin-bottom:6px;
}

.numpad{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:8px;
}

.num-btn{
  height:48px;
  background:#1c222d;
  border-radius:8px;
  font-size:20px;
  color:#fff;
  display:flex;
  align-items:center;
  justify-content:center;
}
</style>
</head>

<body>

<!-- HUD -->
<div class="hud-container">
  <div class="hud-block left">
    <span class="label-sm">ç¸½é ç®—æ™‚é–“</span>
    <div class="glass-box" onclick="setFocus('classTime')">
      <input id="classTime" readonly placeholder="0">
    </div>
  </div>

  <div class="hud-block">
    <span class="label-sm">å‰©é¤˜æ™‚é–“</span>
    <div id="remText" class="main-number">0åˆ†00ç§’</div>
  </div>

  <div class="hud-block right">
    <span class="label-sm">ç¸½è·é›¢</span>
    <div id="totalDist" class="dist-big">0 m</div>
  </div>
</div>

<!-- Panel -->
<div class="panel">

  <div class="row">
    <div style="flex:1">
      <span class="label-sm">å–®è¶Ÿ/åˆ†</span>
      <div class="glass-box" onclick="setFocus('lapMin')"><input id="lapMin" readonly></div>
    </div>
    <div style="flex:1">
      <span class="label-sm">å–®è¶Ÿ/ç§’</span>
      <div class="glass-box" onclick="setFocus('lapSec')"><input id="lapSec" readonly></div>
    </div>
    <div style="flex:1.2">
      <span class="label-sm">å–®è¶Ÿ/è·é›¢</span>
      <div class="glass-box" onclick="setFocus('lapDist')"><input id="lapDist" readonly><span class="unit">m</span></div>
    </div>
    <div style="flex:.8">
      <span class="label-sm">å–®è¶Ÿæ•¸</span>
      <div class="glass-box" onclick="setFocus('laps')"><input id="laps" readonly></div>
    </div>
  </div>

  <div class="row">
    <div style="flex:1">
      <span class="label-sm">çµ„æ•¸</span>
      <div class="glass-box" onclick="setFocus('sets')"><input id="sets" readonly></div>
    </div>
    <div style="flex:1">
      <span class="label-sm">çµ„ä¼‘/åˆ†</span>
      <div class="glass-box" onclick="setFocus('restMin')"><input id="restMin" readonly></div>
    </div>
    <div style="flex:1">
      <span class="label-sm">çµ„ä¼‘/ç§’</span>
      <div class="glass-box" onclick="setFocus('restSec')"><input id="restSec" readonly></div>
    </div>
  </div>

  <div class="row">
    <div style="flex:1">
      <span class="label-sm">èª²ç¨‹å…§å®¹</span>
      <input id="note" placeholder="Warm up / æŠ€è¡“ / Main set" style="width:100%;padding:8px;border-radius:6px;border:none">
    </div>
    <button class="btn-add" onclick="addItem()">åŠ å…¥</button>
  </div>

</div>

<div class="list-area" id="listArea"></div>

<footer class="fixed-footer">
  <div class="footer-ctrl">
    <button onclick="exportTxt()">ğŸ“¤ åŒ¯å‡ºæ–‡å­—</button>
    <button onclick="resetAll()">é‡ç½®</button>
  </div>

  <div class="numpad">
    <div class="num-btn" onclick="press(7)">7</div><div class="num-btn" onclick="press(8)">8</div><div class="num-btn" onclick="press(9)">9</div>
    <div class="num-btn" onclick="press(4)">4</div><div class="num-btn" onclick="press(5)">5</div><div class="num-btn" onclick="press(6)">6</div>
    <div class="num-btn" onclick="press(1)">1</div><div class="num-btn" onclick="press(2)">2</div><div class="num-btn" onclick="press(3)">3</div>
    <div class="num-btn" onclick="cls()">AC</div><div class="num-btn" onclick="press(0)">0</div><div class="num-btn" onclick="del()">âŒ«</div>
  </div>
</footer>

<script>
let focus='classTime';
let items=[];

function setFocus(id){focus=id}
function press(n){
  const el=document.getElementById(focus);
  if(!el)return;
  el.value=(el.value||"")+n;
}
function del(){const el=document.getElementById(focus);if(el)el.value=el.value.slice(0,-1)}
function cls(){const el=document.getElementById(focus);if(el)el.value=""}

function addItem(){
  const g=id=>+document.getElementById(id).value||0;
  const note=document.getElementById('note').value||'æœªå‘½åèª²ç¨‹';

  const lapTime=g('lapMin')*60+g('lapSec');
  const lapDist=g('lapDist');
  const laps=g('laps');
  const sets=g('sets');
  const rest=g('restMin')*60+g('restSec');

  if(!lapTime||!lapDist||!laps||!sets)return;

  const move=lapTime*laps*sets;
  const restT=rest*(sets-1);
  const dist=lapDist*laps*sets;

  items.push({note,move,rest:restT,dist,lapTime,lapDist,laps,sets});
  render();
}

function render(){
  const list=document.getElementById('listArea');
  list.innerHTML=items.map((i,idx)=>`
    <div class="course-card">
      <div>
        <b>${idx+1}. ${i.note}</b>
        <p>${i.lapDist}m Ã— ${i.laps}è¶Ÿ Ã— ${i.sets}çµ„</p>
      </div>
      <div>${i.dist}m</div>
    </div>
  `).join('');

  const used=items.reduce((s,i)=>s+i.move+i.rest,0);
  const total=(+classTime.value||0)*60-used;
  remText.textContent=`${Math.floor(Math.abs(total)/60)}åˆ†${String(Math.abs(total)%60).padStart(2,'0')}ç§’`;
  remText.classList.toggle('warn',total<0);
  totalDist.textContent=items.reduce((s,i)=>s+i.dist,0)+" m";
}

function exportTxt(){
  let txt="æ¸¸æ³³èª²è¡¨\n\n";
  items.forEach((i,n)=>{
    txt+=`${n+1}. ${i.note}\n${i.lapDist}m Ã— ${i.laps}è¶Ÿ Ã— ${i.sets}çµ„\n\n`;
  });
  const blob=new Blob([txt],{type:'text/plain'});
  const a=document.createElement('a');
  a.href=URL.createObjectURL(blob);
  a.download="swim_plan.txt";
  a.click();
}

function resetAll(){items=[];render()}
</script>
</body>
</html>

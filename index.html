<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>游泳規劃器 CYBERPUNK</title>
<style>
/* ===== 基礎重置 ===== */
* { box-sizing: border-box; margin: 0; padding: 0; touch-action: manipulation; -webkit-tap-highlight-color: transparent; }
:root {
  --primary: #00f0ff;
  --success: #4cf078;
  --warn: #ff2e54;
  --bg-dark: #0b0d17;
  --panel-bg: #121426;
  --input-bg: #0d101c;
  --button-bg: linear-gradient(145deg, #0ff, #00a2ff);
}
html, body { font-family: "SF Pro Text","PingFang TC",sans-serif; background: #0b0d17; color: #e0e0e0; height:100dvh; overflow:hidden; }
.app { display:flex; flex-direction:column; height:100dvh; }

/* ===== Header ===== */
.fixed-header { flex-shrink:0; padding-top:max(15px, env(safe-area-inset-top)); background:#0b0d17; border-bottom:1px solid #222; }
.header-hud { display:flex; justify-content:space-between; align-items:flex-end; padding:10px 15px; gap:10px; }
.input-box { background: var(--input-bg); border: 1px solid #333; border-radius:8px; padding:5px; flex:1; text-align:center; }
.input-box.active { border-color: var(--primary); box-shadow: 0 0 10px var(--primary); }
.val-group input { width:100%; background:transparent; border:none; color:#fff; font-size:18px; font-weight:800; text-align:center; outline:none; }
.unit { font-size:10px; color:#555; margin-left:2px; }
.time-overlay { display:flex; flex-direction:column; align-items:flex-end; border-left:1px solid #333; padding-left:10px; gap:2px; min-width:90px; }
.time-overlay .main-number { font-size:20px; font-weight:900; }
.time-overlay .bg-number { font-size:36px; color:#222; position:absolute; opacity:0.5; right:15px; top:8px; }

/* ===== Input Section ===== */
.input-section { padding:10px 15px; display:flex; flex-direction:column; gap:6px; border-bottom:1px solid #222; }
.row { display:flex; gap:6px; align-items:flex-end; }
.rest-and-add { display:flex; gap:6px; align-items:center; }
.btn-add { flex:1; background:var(--button-bg); color:#fff; border:none; border-radius:8px; font-weight:900; font-size:14px; padding:8px; }
.btn-add:active { transform:scale(0.97); }

/* ===== Main Content ===== */
.main-content { flex:1; overflow-y:auto; padding:10px 15px; background:#0b0d17; -webkit-overflow-scrolling: touch; }
.course-item { background:#121426; padding:10px; border-radius:8px; display:flex; justify-content:space-between; align-items:center; border-left:4px solid var(--primary); margin-bottom:6px; }
.item-info b { font-size:13px; color:#fff; }
.item-info p { font-size:10px; color:#888; }
.item-time { font-size:16px; font-weight:800; color:#fff; }

/* ===== Footer ===== */
.fixed-footer { flex-shrink:0; background:#0b0d17; border-top:1px solid #222; padding-bottom:max(10px, env(safe-area-inset-bottom)); }
.footer-ctrl { display:flex; justify-content:space-between; padding:5px 15px; }
.btn-reset { background:#222; border:1px solid var(--warn); color:var(--warn); padding:4px 10px; border-radius:6px; font-size:10px; font-weight:bold; }
.numpad { display:grid; grid-template-columns:repeat(3,1fr); gap:6px; padding:5px 15px; }
.numpad button { border:none; border-radius:8px; padding:10px 0; font-size:22px; font-weight:800; color:#fff; background:#121426; }
.numpad button:active { background:#0f111b; }
.btn-util { color:#666; font-size:14px; }
.warn { color:var(--warn); }
</style>
</head>
<body>
<div class="app">
  <header class="fixed-header">
    <div class="header-hud">
      <div style="flex:1; display:flex; flex-direction:column; gap:2px;">
        <span style="font-size:10px;color:#888;">總長度 (分)</span>
        <div class="input-box" id="box-classTime"><div class="val-group"><input id="classTime" placeholder="0"></div></div>
      </div>
      <div class="time-overlay">
        <span style="font-size:10px;color:#888;">剩餘可用</span>
        <div id="remainingText" class="main-number">0分00秒</div>
      </div>
    </div>
    <section class="input-section">
      <div class="row">
        <div style="flex:1; display:flex; gap:6px;">
          <div style="flex:1; display:flex; flex-direction:column;"><span style="font-size:10px;color:#888;">單趟時間</span><div class="input-box" id="box-lapMin"><div class="val-group"><input id="lapMin" placeholder="0"><span class="unit">分</span></div></div></div>
          <div style="flex:1; display:flex; flex-direction:column;"><span style="font-size:10px;color:#888;"> </span><div class="input-box" id="box-lapSec"><div class="val-group"><input id="lapSec" placeholder="0"><span class="unit">秒</span></div></div></div>
        </div>
        <div style="flex:1; display:flex; gap:6px;">
          <div style="flex:1; display:flex; flex-direction:column;"><span style="font-size:10px;color:#888;">訓練結構</span><div class="input-box" id="box-lapsPerSet"><div class="val-group"><input id="lapsPerSet" placeholder="0"><span class="unit">趟</span></div></div></div>
          <div style="flex:1; display:flex; flex-direction:column;"><span style="font-size:10px;color:#888;"> </span><div class="input-box" id="box-sets"><div class="val-group"><input id="sets" placeholder="0"><span class="unit">組</span></div></div></div>
        </div>
      </div>
      <div class="row rest-and-add">
        <div style="flex:2; display:flex; gap:6px;">
          <div style="flex:1; display:flex; flex-direction:column;"><span style="font-size:10px;color:#888;">組間休息</span><div class="input-box" id="box-restMin"><div class="val-group"><input id="restMin" placeholder="0"><span class="unit">分</span></div></div></div>
          <div style="flex:1; display:flex; flex-direction:column;"><span style="font-size:10px;color:#888;"> </span><div class="input-box" id="box-restSec"><div class="val-group"><input id="restSec" placeholder="0"><span class="unit">秒</span></div></div></div>
        </div>
        <button class="btn-add" onclick="addItem()">加入項目 (+)</button>
      </div>
    </section>
  </header>

  <main id="scrollArea" class="main-content">
    <div id="listContainer"></div>
  </main>

  <footer class="fixed-footer">
    <div class="footer-ctrl">
      <span style="font-size:9px;color:#444;font-weight:bold;">LONG PRESS TO DELETE</span>
      <button class="btn-reset" onclick="clearAll()">重置資料</button>
    </div>
    <div class="numpad">
      <button onclick="num(7)">7</button><button onclick="num(8)">8</button><button onclick="num(9)">9</button>
      <button onclick="num(4)">4</button><button onclick="num(5)">5</button><button onclick="num(6)">6</button>
      <button onclick="num(1)">1</button><button onclick="num(2)">2</button><button onclick="num(3)">3</button>
      <button class="btn-util" onclick="clearInput()">AC</button>
      <button onclick="num(0)">0</button>
      <button class="btn-util" style="color:var(--warn);" onclick="back()">⌫</button>
    </div>
  </footer>
</div>
<script>
let activeInput=document.getElementById("classTime");
let items=[];let pressTimer=null;
const vibrate=ms=>{if(navigator.vibrate)navigator.vibrate(ms);};
const formatTimeCH=s=>`${Math.floor(s/60)}分${(s%60).toString().padStart(2,'0')}秒`;
function updateFocusUI(el){document.querySelectorAll('.input-box').forEach(b=>b.classList.remove('active'));let p=el.closest('.input-box');if(p)p.classList.add('active');}
document.querySelectorAll("input").forEach(input=>input.addEventListener("click",e=>{activeInput=input;updateFocusUI(input);e.stopPropagation();}));
function num(n){if(!activeInput)return;if(activeInput.value.length>=3)return;activeInput.value+=n;vibrate(10);render();}
function back(){if(activeInput&&activeInput.value.length>0){activeInput.value=activeInput.value.slice(0,-1);render();}}
function clearInput(){if(activeInput){activeInput.value='';render();}}
function addItem(){const getVal=id=>+document.getElementById(id).value||0;const lm=getVal("lapMin"),ls=getVal("lapSec"),lps=getVal("lapsPerSet"),st=getVal("sets"),rm=getVal("restMin"),rs=getVal("restSec");if(st<=0||lps<=0){vibrate([50,50]);return;}const total=((lm*60+ls)*lps*st)+((rm*60+rs)*(st>1?st-1:0));items.push({id:Date.now(),desc:`${lps}趟 x ${st}組`,seconds:total});["lapMin","lapSec","lapsPerSet","sets","restMin","restSec"].forEach(id=>document.getElementById(id).value='');activeInput=document.getElementById("lapMin");updateFocusUI(activeInput);render();const sa=document.getElementById("scrollArea");setTimeout(()=>sa.scrollTo({top:sa.scrollHeight,behavior:'smooth'}),100);}
function render(){const classVal=+document.getElementById("classTime").value||0;document.getElementById("remainingText").innerText=formatTimeCH(classVal*60-items.reduce((sum,it)=>sum+it.seconds,0));const container=document.getElementById("listContainer");container.innerHTML="";items.forEach((item,index)=>{const div=document.createElement("div");div.className="course-item";div.innerHTML=`<div class="item-info"><b>項目 #${index+1}</b><p>${item.desc}</p></div><div class="item-time">${formatTimeCH(item.seconds)}</div>`;div.ontouchstart=()=>{pressTimer=setTimeout(()=>{vibrate(50);if(confirm("刪除此項目？")){items.splice(index,1);render();}},600);};div.ontouchend=()=>clearTimeout(pressTimer);container.appendChild(div);});}
function clearAll(){if(confirm("確定清空所有數據？")){items=[];document.getElementById("classTime").value="";render();vibrate(60);}}
updateFocusUI(activeInput);render();
</script>
</body>
</html>
